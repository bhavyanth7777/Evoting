<!DOCTYPE html>
<html>

<head>

  <meta charset="UTF-8">

  <title>CSI | eVoting Portal</title>

  <link rel="stylesheet" href="static/css/normalize.css">

    <link rel="stylesheet" href="static/css/style.css" media="screen" type="text/css" />
    <link rel="stylesheet" href="static/css/style2.css" media="screen" type="text/css" />

    <script src="static/js/modernizr.js"></script>
    <script src="static/js/jquery.js"></script>
    <script src="static/js/vui.js"></script>
    
</head>
<!--
  All the link/overlays/content start from 1. 
  By default 1 is visible and the rest are hidden. 
-->
<body>
     
  <script type="text/javascript">
  var ws = new WebSocket("ws://localhost:8888/ws");
  // We add +2 because review section also comes after all positions. 
  $(document).ready(function()
  {
      {% for i in range(2,len(positions)+2) %}
          $('#ev-wrapper{{i}}').hide();
      {% end %}

      {% for i in range(1,len(positions)+2) %}
          $('#link_{{i}}').click(function()
           {
              {% for x in range(1,len(positions)+2) %} 
                  $('#ev-wrapper{{x}}').hide();
              {%end%}
              $('#ev-wrapper{{i}}').show();
            }
          );
      {%end%}
  });
  //  Onclick Voting using sockets. 
  function vote(n,p,pname)
  {
    var id = n;
    var position = p;
    var nameOfCandidate = pname;
    var messageToServer = {messageType:"voted", messageData:'', 'id':id, 'position':position, 'candidateName':pname};
    messageToServer = JSON.stringify(messageToServer);
    ws.send(messageToServer);
  };
  function getSelectedCandidates()
  {
    alert('lol');
    var messageToServer = {messageType:"getSelectedCandidates", messageData:''}
    messageToServer = JSON.stringify(messageToServer)
    ws.send(messageToServer)
  }
  ws.onopen = function(evt)
  {
      //alert("socket opened client side");

  }
  ws.onclose = function(evt)
  {
      //alert("socket closed client side");
  }
  ws.onmessage = function(evt) 
  {
      //alert("Received message");
      messageFromServer = evt.data;
      messageFromServer = JSON.parse(messageFromServer);
      messageType = messageFromServer.messageType;
      if (messageType=="votedVerificaiton")
      {
          message = messageFromServer.message;
          alert(message);
      }
      else if (messageType = "selectedCandidate")
      {
          alert ('received');
          candidates = JSON.stringify(messageFromServer.message);
          alert(candidates);
      }
  }
  </script>
      
<!--   Overlay for fixed sidebar -->
<div class="sidebar-overlay"></div>

<!-- Material sidebar -->
<aside id="sidebar" class="sidebar sidebar-default open" role="navigation">
   
<div>
    <!-- Sidebar navigation -->
    <ul class="nav sidebar-nav">
        
        <li>
            <a href="#">
                <!--i class="sidebar-icon md-inbox"></i-->
                My Profile
            </a>
        </li>
        <li>
            <a href="#">
                <!--i class="sidebar-icon md-inbox"></i-->
                Help
            </a>
        </li>
        <li>
            <a href="/logout" id="">
                <!--i class="sidebar-icon md-inbox"></i-->
                Logout
            </a>
        </li>
        <p style="margin-left:5%;"><font size=4>Choose Your Candidates</font></p>
        <li class="divider"></li>
        
        <!-- To print all the positions on the sidebar -->
        {% for i in range(len(positions))%}
        <li>
            <a href="#" id="link_{{i+1}}">
                <!--i class="sidebar-icon md-inbox"></i-->
                 {{positions[i]}}
            </a>
        </li>
        {% end %}
        
        <li class="divider"></li>
        <li>
            <a href="#" id="link_{{len(positions)+1}}" onclick="getSelectedCandidates()">
                <!--i class="sidebar-icon md-drafts"></i-->
                Review Candidates & Submit
            </a>
        </li>
        <li class="divider"></li>
        
    </ul>
    
    <div id="fontlinks">
        <p>You logged in from: {{ip}}</p>
    		<a href="#" id="incfont" class="button buttonfont">A+</a>
    		<a href="#" id="decfont" class="button buttonfont">A-</a>
    </div>
    
    <img src="static/img/logo.png" width="100" height="100" style="margin-left: 5%; margin-top: 10%;">

    <!-- Sidebar divider -->
    <!-- <div class="sidebar-divider"></div> -->

    <!-- Sidebar text -->
    <!--  <div class="sidebar-text">Text</div> -->
</aside>

<div class="wrapper" id="content">
    <!--For all the different positions.-->
    {% for i in range(len(candidatesList)) %}
      <div class="ev-wrapper" id="ev-wrapper{{i+1}}">
        <div class="ev-header">
          <small>February 21, 2015 &mdash; February 25, 2015</small>
          <h2 class="ev-headline">{{positions[i]}} Nominations</h2>
        </div>
      
        <ul class="ev-user">
            <!-- For all the different candidates in each position -->
            {% for s in range(len(candidatesList[i])) %}
              <li class="ev-user-{{s+1}} finalist-{{s+1}}">
                <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
              
                <h3>{{candidatesList[i][s]}}</h3>
                <p>CSI, Punjab</p>
                <a href="#" class="ev-voting-launch ev-btn" rel="finalist-{{s+1}}">
                  <span class="text">Select & Save</span>
                  <span class="overlay"></span>
                </a>
              </li>
            {% end %}
        </ul>

        <ul class="ev-content">
          {% for n in range(1,len(candidatesList[i])+1) %}
            <li class="ev-content-{{n}} finalist-{{n}}">
              <div class="ev-content-body">
                <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>            
                <h3>{{candidatesList[i][n-1]}}</h3>
                <p>CSI, Punjab</p>
                <p>{{ description[i][n-1]}}</p>
                <div class="ev-video">
                  <p><a href="#" class="ev-voting-launch ev-btn" rel="finalist-{{n}}">Select & Save Candidate</a></p>
                </div>
              </div>
              <div class="ev-overlay ev-overlay-{{n}}">
                <div class="ev-overlay-content">
                  <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
                  <h3>Select <span>{{candidatesList[i][n-1]}}</span></h3>
                  <a href="#" onclick="vote({{ idList[i][n-1] }},'{{ positions[i]}}','{{candidatesList[i][n-1] }}');" class="ev-vote ev-vote-finalist-{{n}} ev-btn">Yes!</a> <a href="#" class="ev-vote-cancel ev-btn">Cancel</a>
                </div>
              </div>
            </li>
          {% end %}
        </ul>
      </div>
    {% end %}
    
    <!--REVIEW SECTION-->
    <div class="ev-wrapper" id="ev-wrapper{{len(positions)+1}}" style="background-color:#F5F5F5; margin-left:40px;">
        <div class="ev-header">
          <small>February 21, 2015 &mdash; February 25, 2015</small>
          <h2 class="ev-headline">Review your candidate selections</h2>
        </div>
        
        <ul class="ev-user" style="color:green">
          <li class="ev-user-1 finalist-1">
            <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
            <h3>Candidate A</h3>
            <p>CSI, Punjab</p>
            <p class="ev-voting-launch ev-btn-edit" rel="finalist-1">
              <span class="text">For President</span>
                
            </p>
              <p>Click the button above to edit your choice.</p>
              
              <div class="ev-overlay ev-overlay-2">
              <div class="ev-overlay-content">
                
                <h3>Edit President Elect?</h3>
                <a href="#" class="ev-vote ev-vote-finalist2 ev-btn" rel="75487" style="margin-top:50px">Edit</a> <a href="#" class="ev-vote-cancel ev-btn">Cancel</a>
              </div>
            </div>
          </li>
            

          <li class="ev-user-2 finalist-2">
            <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
            <h3>Candidate B</h3>
            <p>CSI, Gujarat</p>
            <p class="ev-voting-launch ev-btn-edit" rel="finalist-2">
              <span class="text">For Vice President</span>
            </p>
               <p>Click the button above to edit your choice.</p>
              
              
            <div class="ev-overlay ev-overlay-2">
              <div class="ev-overlay-content">
                
                <h3>Edit Vice President Elect?</h3>
                <a href="#" class="ev-vote ev-vote-finalist2 ev-btn" rel="75487" style="margin-top:50px">Edit</a> <a href="#" class="ev-vote-cancel ev-btn">Cancel</a>
              </div>
            </div>
          </li>
          <li class="ev-user-3 finalist-3">
            <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
            <h3>Candidate C</h3>
            <p>CSI, MP</p>
            <p class="ev-voting-launch ev-btn-edit" rel="finalist-3">
              <span class="text">For Technical Director</span>
            </p>
               <p>Click the button above to edit your choice.</p>
              
              <div class="ev-overlay ev-overlay-3">
              <div class="ev-overlay-content">
                
                <h3>Edit Technical Director Elect?</span></h3>
                <a href="#" class="ev-vote ev-vote-finalist-3 ev-btn" rel="75486" style="margin-top:50px">Edit</a> <a href="#" class="ev-vote-cancel ev-btn">Cancel</a>
              </div>
            </div>
          </li>
          <li class="ev-user-4 finalist-4">
            <span class="ev-headshot"><img src="http://thevillaatnorthend.co.uk/img/image-waiting.png" width="160" height="160" /></span>
            <h3>Candidate D</h3>
            <p>CSI, Mumbai</p>
            <p class="ev-voting-launch ev-btn-edit" rel="finalist-4">
              <span class="text">For Assistant Director</span>
            </p>
               <p>Click the button above to edit your choice.</p>
            <div class="ev-overlay ev-overlay-4">
              <div class="ev-overlay-content">
                
                <h3>Edit Assistant Director Elect?</span></h3>
                <a href="#" class="ev-vote ev-vote-finalist-4 ev-btn" rel="75490" style="margin-top:50px">Edit</a> <a href="#" class="ev-vote-cancel ev-btn">Cancel</a>
              </div>
            </div>
          </li>
        </ul>

    <ul class="ev-content-edit">
          
        <form>
            
            <input type="checkbox" name="submit"> I have reviewed my selections.<br><br>
        
        One Type Password (OTP): <input type="text" name="otp" placeholder="Enter your OTP Here"><br><br>
        <div class="ev-video">
                <p><a href="#" class="ev-btn" rel="finalist-2">Submit</a></p>
            </div>
                
        </form>
        </ul>
        
    </div>
        
    
        <!--div class="loginfooter" align="center" style="margin-top:200px">
    <p>&copy; 2015 Computer Society of India. All Rights Reserved.</p>
      </div-->

    </div>

</div>

  <script src='https://maxcdn.bootstrapcdn.com/bootstrap/3.2.0/js/bootstrap.min.js'></script>

  <script src="js/index.js"></script>
    
<script type="text/javascript">
	 $(document).ready(function() { 
		$('#incfont').click(function(){	   
        curSize= parseInt($('#content').css('font-size')) + 2;
		if(curSize<=20)
        $('#content').css('font-size', curSize);
        });  
		$('#decfont').click(function(){	   
        curSize= parseInt($('#content').css('font-size')) - 2;
		if(curSize>=12)
        $('#content').css('font-size', curSize);
        }); 
	});
</script>


</body>

</html>